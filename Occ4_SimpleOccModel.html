<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Simple occupancy models</title>

<script src="site_libs/header-attrs-2.21/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/clipboard-1.7.1/clipboard.min.js"></script>
<link href="site_libs/primer-tooltips-1.4.0/build.css" rel="stylesheet" />
<link href="site_libs/klippy-0.0.0.9500/css/klippy.min.css" rel="stylesheet" />
<script src="site_libs/klippy-0.0.0.9500/js/klippy.min.js"></script>
<link href="site_libs/font-awesome-6.4.0/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.0/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>





<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Quantitative conservation biogeography</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Pracs: occupancy modelling
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Occ0_setup.html">0. Getting started</a>
    </li>
    <li>
      <a href="Occ1_SpatialData.html">1. Spatial data in R</a>
    </li>
    <li>
      <a href="Occ2_SpeciesData.html">2. Species data in R</a>
    </li>
    <li>
      <a href="Occ3_EnvData.html">3. Environmental data in R</a>
    </li>
    <li>
      <a href="Occ4_SimpleOccModel.html">4. Simple occupancy models</a>
    </li>
    <li>
      <a href="Occ5_EvalPred.html">5. Occupancy models: evaluation &amp; prediction</a>
    </li>
    <li>
      <a href="Occ6_DynamicOccModel.html">6. Dynamic occupancy models</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Pracs: population modelling
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="RS1_overview.html">1. Getting started with RangeShiftR</a>
    </li>
    <li>
      <a href="RS2_lynx.html">2. Eurasian lynx reintroduction</a>
    </li>
    <li>
      <a href="RS3_blackgrouse.html">3. Black grouse range dynamics</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://www.uni-potsdam.de/en/ibb-macroecology/index">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/ZurellLab">
    <span class="fa fa-twitter"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Simple occupancy models</h1>

</div>


<script>
  addClassKlippyTo("pre.r, pre.markdown");
  addKlippy('right', 'top', 'auto', '1', 'Copy code', 'Copied!');
</script>
<hr />
<div class="alert alert-info">
<p><strong>RStudio project</strong></p>
<p>Open the RStudio project that we created in the previous session. I
recommend to use this RStudio project for the entire module and within
the RStudio project create separate R scripts for each session.</p>
<ul>
<li>Create a new empty R script by going to the tab “File”, select “New
File” and then “R script”</li>
<li>In the new R script, type
<code># Session Occ-4: Simple occupancy models</code> and save the file
in your folder “scripts” within your project folder, e.g. as
“Occ4_SimpleOccModel.R”</li>
</ul>
</div>
<div id="introduction" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Introduction</h1>
<p>We have already heard that occupancy (or occupancy-detection) models
can deal with imperfect detection in species distribution modelling
<span class="citation">(Guillera-Arroita 2017; Kéry and Royle
2015)</span>. In the following, we will focus on false negative errors
(not recording a species although present) as these tend to be more
common in surveys than false positive errors (recording a species
although absent). Accounting for this imperfect detection requires a
hierarchical model structure in which we describe two separate
processes:</p>
<ul>
<li><p>the system or state process that represents the underlying
biological state, here the presence/absence of a species at site
<em>i</em>:</p>
<p><span class="math inline">\(z_i \sim
Bernoulli(\psi_i)\)</span></p></li>
<li><p>the observation process that describes the data observation or
collection, here the probability of observing a species during survey
<em>j</em> if the species is indeed present at site <em>i</em>:</p>
<p><span class="math inline">\(y_{ii}|z_i \sim
Bernoulli(z_i*p_{ij})\)</span></p></li>
</ul>
<p>where</p>
<p><span class="math inline">\(\psi_i\)</span> .. the probability of
occupancy (species presence) at site <em>i</em></p>
<p><span class="math inline">\(z_i\)</span> .. the true state of
occupancy of site <em>i</em></p>
<p><span class="math inline">\(p_{ij}\)</span> .. the detection
probability of the study species at site <em>i</em> during survey
<em>j</em></p>
<p><span class="math inline">\(y_{ij}\)</span> .. the observed data (our
observation of presence/absence) at site <em>i</em> during survey
<em>j</em></p>
<p>Thus, we want to predict the probability of detecting a species
conditional on the probability of occupancy of that species. Each
process can be described as a function of environmental covariates
(predictor variables). The site covariates describe how occupancy varies
across environmental gradients, the survey covariates describe how
detection varies across environmental gradients.</p>
<p>To tease apart the state process and the observation process, we need
information about how detections took place <span
class="citation">(Guillera-Arroita 2017)</span>. These typically stem
from repeat visits at a site (over time or by several observers), from
multiple independent detection methods, or from spatial subsampling. If
the species is observed (<span class="math inline">\(y=1\)</span>), then
also the true state of occupancy is a presence (<span
class="math inline">\(z=1\)</span>). However, if the species is not
observed (<span class="math inline">\(y=0\)</span>), the true state of
occupancy could be either a presence (<span
class="math inline">\(z=1\)</span>) but the species was simply not
observed (with probability of <span class="math inline">\(1-p\)</span>),
or the true state could indeed by an absence (<span
class="math inline">\(z=0\)</span>).</p>
<p>When repeat visits are undertaken, these should be close enough in
time to avoid any violation of the closure assumption. This assumes that
occupancy remains constant between the repeat visits, e.g. no emigration
or colonisation takes place over this time frame.</p>
<p>In this course, we will use two linked GLMs (generalised linear
models) to describe the state process and the observation process.</p>
<div id="generalised-linear-models-glms" class="section level2"
number="1.1">
<h2><span class="header-section-number">1.1</span> Generalised linear
models (GLMs)</h2>
<p>Generalised linear models (GLMs) are useful when our response
variable is not normally distributed. Remember that ordinary least
squares (OLS) linear regression assumes normally distributed data within
the ranges (<span class="math inline">\(-\infty,\infty\)</span>). OLS
regression looks like this</p>
<p><span class="math display">\[E(Y|X)=\beta X+\epsilon\]</span></p>
<p>where <span class="math inline">\(E(Y|X)\)</span> is the
<em>conditional mean</em>, meaning the expected value of the response
<span class="math inline">\(Y\)</span> given the environmental
predictors <span class="math inline">\(X\)</span> <span
class="citation">(Hosmer and Lemeshow 2013)</span>. <span
class="math inline">\(X\)</span> is the matrix of predictors (including
the intercept), <span class="math inline">\(\beta\)</span> are the
coefficients for the predictors, and <span
class="math inline">\(\epsilon\)</span> is the (normally distributed)
error term. <span class="math inline">\(\beta X\)</span> is referred to
as the linear predictor.</p>
<p>When we want to predict species occupancy based on environment, then
the conditional mean <span class="math inline">\(E(Y|X)\)</span> is
binary and bounded between 0 (absence) and 1 (presence). Thus, the
assumptions of OLS regression are not met. GLMs are more flexible
regression models that allow the response variable to follow other
distributions. Similar to OLS regression, we also fit a linear predictor
<span class="math inline">\(\beta X\)</span> and then relate this linear
predictor to the mean of the response variable using a link function.
The link function is used to transform the response to normality. In
case of a binary response, we typically use the logit link (or sometimes
the probit link). The conditional mean is then given by:</p>
<p><span class="math display">\[E(Y|X) = \pi (X) = \frac{e^{\beta
X+\epsilon}}{1+e^{\beta X+\epsilon}}\]</span></p>
<p>The logit transformation is defined as: <span
class="math display">\[g(X)  = ln \left( \frac{\pi (X)}{1-\pi (X)}
\right)   = \beta X+\epsilon\]</span></p>
<p>The trick is that the logit, g(X), is now linear in its parameters,
is continuous and may range (<span
class="math inline">\(-\infty,\infty\)</span>). GLMs with a logit link
are also called logistic regression models.</p>
</div>
</div>
<div id="the-simplest-occupancy-models-without-covariates"
class="section level1" number="2">
<h1><span class="header-section-number">2</span> The simplest occupancy
models (without covariates)</h1>
<p>We have already prepared a dataset with repeat observations for the
red kite in Practical 2 and merged it with environmental data in
Practical 3. These data contain the observed detection/non-detection of
red kites in Spain in 5 km cells for the months April to June. I have
further spatially thinned the data; you can download the resulting
dataset <a href="data/redkite_env_thinned.RData">here</a>. Also download
the 5km mask of Spain (we created this in Practical 2, available <a
href="data/mask_Esp_5km.tif">here</a>). Please store all data in your
“data” folder.</p>
<p>Please be aware that our oversimplified workflow for collating the
eBird data does not correspond to best practices. The eBird best
practices and more elaborate workflows are described here: <a
href="https://cornelllabofornithology.github.io/ebird-best-practices"
class="uri">https://cornelllabofornithology.github.io/ebird-best-practices</a>.
The main purpose of the present practicals is to exemplify the workflow
and basic functionality of occupancy models using freely available
data.</p>
<pre class="r"><code># Load species data:
load(&#39;data/redkite_env_thinned.RData&#39;)

summary(redkite_env_thinned)</code></pre>
<pre><code>##        x                y              cell           month4       
##  Min.   :-9.079   Min.   :36.09   Min.   : 1740   Min.   :0.00000  
##  1st Qu.:-5.579   1st Qu.:39.30   1st Qu.:13705   1st Qu.:0.00000  
##  Median :-3.746   Median :40.92   Median :24301   Median :0.00000  
##  Mean   :-3.377   Mean   :40.63   Mean   :26624   Mean   :0.03675  
##  3rd Qu.:-1.329   3rd Qu.:42.21   3rd Qu.:37417   3rd Qu.:0.00000  
##  Max.   : 3.129   Max.   :43.67   Max.   :63491   Max.   :1.00000  
##      month5            month6              ID          ESP_elv       
##  Min.   :0.00000   Min.   :0.00000   Min.   :   8   Min.   :  -2.84  
##  1st Qu.:0.00000   1st Qu.:0.00000   1st Qu.: 998   1st Qu.: 338.48  
##  Median :0.00000   Median :0.00000   Median :1917   Median : 625.52  
##  Mean   :0.03828   Mean   :0.04288   Mean   :1909   Mean   : 655.62  
##  3rd Qu.:0.00000   3rd Qu.:0.00000   3rd Qu.:2848   3rd Qu.: 897.56  
##  Max.   :1.00000   Max.   :1.00000   Max.   :3698   Max.   :2267.32  
##      bio_1            bio_2            bio_3           bio_4      
##  Min.   : 2.069   Min.   : 6.643   Min.   :29.15   Min.   :337.0  
##  1st Qu.:11.440   1st Qu.:10.018   1st Qu.:37.87   1st Qu.:567.8  
##  Median :13.297   Median :11.093   Median :39.53   Median :623.1  
##  Mean   :13.194   Mean   :11.079   Mean   :39.58   Mean   :606.8  
##  3rd Qu.:15.223   3rd Qu.:12.274   3rd Qu.:41.21   3rd Qu.:660.0  
##  Max.   :18.476   Max.   :15.122   Max.   :46.41   Max.   :762.8  
##      bio_5           bio_6            bio_7           bio_8        
##  Min.   :18.46   Min.   :-9.220   Min.   :16.32   Min.   :-0.8033  
##  1st Qu.:27.14   1st Qu.:-0.460   1st Qu.:25.95   1st Qu.: 7.5933  
##  Median :29.67   Median : 1.132   Median :28.58   Median : 9.8760  
##  Mean   :29.28   Mean   : 1.261   Mean   :28.02   Mean   :10.1266  
##  3rd Qu.:32.19   3rd Qu.: 3.036   3rd Qu.:30.63   3rd Qu.:12.9427  
##  Max.   :36.18   Max.   : 8.200   Max.   :36.14   Max.   :19.4513  
##      bio_9            bio_10          bio_11           bio_12      
##  Min.   : 2.585   Min.   :10.70   Min.   :-5.193   Min.   : 218.2  
##  1st Qu.:17.205   1st Qu.:18.96   1st Qu.: 4.472   1st Qu.: 426.1  
##  Median :20.058   Median :21.46   Median : 6.286   Median : 540.0  
##  Mean   :19.108   Mean   :21.09   Mean   : 6.327   Mean   : 641.1  
##  3rd Qu.:23.494   3rd Qu.:23.68   3rd Qu.: 8.332   3rd Qu.: 725.8  
##  Max.   :26.275   Max.   :26.28   Max.   :12.669   Max.   :1816.6  
##      bio_13           bio_14          bio_15          bio_16      
##  Min.   : 29.88   Min.   : 0.00   Min.   :18.29   Min.   : 86.24  
##  1st Qu.: 55.56   1st Qu.: 7.00   1st Qu.:29.24   1st Qu.:147.88  
##  Median : 74.60   Median :15.88   Median :37.06   Median :202.80  
##  Mean   : 84.25   Mean   :20.17   Mean   :39.51   Mean   :230.25  
##  3rd Qu.: 99.00   3rd Qu.:27.96   3rd Qu.:47.83   3rd Qu.:272.40  
##  Max.   :258.76   Max.   :77.12   Max.   :77.80   Max.   :713.12  
##      bio_17           bio_18           bio_19           trees        
##  Min.   : 12.92   Min.   : 16.20   Min.   : 65.56   Min.   :0.00000  
##  1st Qu.: 40.48   1st Qu.: 44.00   1st Qu.:115.08   1st Qu.:0.05137  
##  Median : 65.84   Median : 75.12   Median :170.48   Median :0.19214  
##  Mean   : 81.11   Mean   : 89.74   Mean   :200.33   Mean   :0.28622  
##  3rd Qu.:112.88   3rd Qu.:124.52   3rd Qu.:248.76   3rd Qu.:0.49534  
##  Max.   :260.16   Max.   :263.44   Max.   :713.12   Max.   :0.98086  
##     cropland          grassland      
##  Min.   :0.000000   Min.   :0.02362  
##  1st Qu.:0.005316   1st Qu.:0.19864  
##  Median :0.099340   Median :0.27477  
##  Mean   :0.247443   Mean   :0.28716  
##  3rd Qu.:0.461840   3rd Qu.:0.36127  
##  Max.   :0.974008   Max.   :0.67191</code></pre>
<pre class="r"><code># Read in 5km mask of Spain:
library(terra)</code></pre>
<pre><code>## terra 1.7.29</code></pre>
<pre class="r"><code>mask_Esp_5km &lt;- terra::rast(&#39;data/mask_Esp_5km.tif&#39;)

# Map the data:
plot(mask_Esp_5km, col=&#39;grey90&#39;, legend=F)
points(redkite_env_thinned[,1:2],pch=19,col=c(&#39;grey50&#39;,&#39;red&#39;,&#39;violet&#39;,&#39;blue&#39;)[as.factor(rowSums(redkite_env_thinned[,4:6]))], cex=0.3)</code></pre>
<p><img src="Occ4_SimpleOccModel_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<p>We can get a naïve occupancy estimate for the red kite by simply
counting the number of 5 km cells where at least one presence was
recorded during the repeat visits and dividing by the total number of
sites surveyed:</p>
<pre class="r"><code># Naive occupancy estimate:
sum(apply(redkite_env_thinned[,4:6], 1, max)) / nrow(redkite_env_thinned)</code></pre>
<pre><code>## [1] 0.1117917</code></pre>
<p>The naïve estimate is that red kite occupy 11% of the sites. However,
due to false negatives (failure to detect the species although present)
the true occupancy might be underestimated.</p>
<p>To estimate the detection probability for the red kite and the true
occupancy probability, we use the <code>unmarked</code> package <span
class="citation">(Fiske and Chandler 2011)</span>. For this, we first
have to create an object of class <code>unmarkedFrameOccu</code></p>
<pre class="r"><code>library(unmarked)

# Create unmarked object containing the detection and non-detection data:
occ_redkite &lt;- unmarkedFrameOccu(y=redkite_env_thinned[,4:6])</code></pre>
<p>Next, we fit a single season occupancy model using the function
<code>occu()</code> in the <code>unmarked</code> package. This function
requires a double formula that specifies the survey and the site
covariates (predictor variables), first for the detection process and
second for the state (occupancy) process:
<code>occu(~survey covariates ~site covariates)</code>. Here, we will
not add any survey or site covariates, meaning that we simply estimate a
null model:</p>
<pre class="r"><code># Fitting simple single season occupancy models without survey or site covariates (intercept model):
m_occ_null &lt;- occu(~1 ~ 1, occ_redkite)

# Summarise model output:
summary(m_occ_null)</code></pre>
<pre><code>## 
## Call:
## occu(formula = ~1 ~ 1, data = occ_redkite)
## 
## Occupancy (logit-scale):
##  Estimate   SE     z P(&gt;|z|)
##      1.06 1.81 0.587   0.557
## 
## Detection (logit-scale):
##  Estimate    SE     z  P(&gt;|z|)
##     -2.88 0.504 -5.72 1.04e-08
## 
## AIC: 652.9764 
## Number of sites: 653
## optim convergence code: 0
## optim iterations: 32 
## Bootstrap iterations: 0</code></pre>
<p>The estimates for the occupancy probability and the detection
probability are provided at logit scale and we need to back transform
them to get probability estimates between 0 and 1.</p>
<pre class="r"><code># Get detection probability estimate:
(p_det &lt;- backTransform(m_occ_null, &quot;det&quot;))</code></pre>
<pre><code>## Backtransformed linear combination(s) of Detection estimate(s)
## 
##  Estimate     SE LinComb (Intercept)
##    0.0529 0.0253   -2.88           1
## 
## Transformation: logistic</code></pre>
<pre class="r"><code># Get occupancy probability estimate:
(p_psi &lt;- backTransform(m_occ_null, &quot;state&quot;))</code></pre>
<pre><code>## Backtransformed linear combination(s) of Occupancy estimate(s)
## 
##  Estimate    SE LinComb (Intercept)
##     0.743 0.345    1.06           1
## 
## Transformation: logistic</code></pre>
<p>We see that our detection probability is very low at 5%, which
probably leads to severe underestimation of occupancy. And indeed, our
estimated occupancy probability is 74% and thus much higher than our
naïve estimate of 11%.</p>
</div>
<div id="simple-occupancy-models-with-covariates" class="section level1"
number="3">
<h1><span class="header-section-number">3</span> Simple occupancy models
with covariates</h1>
<p>Most of the time we are probably more interested in how far site
covariates affect occupancy probability or even in how far survey
covariates affect detection probability. Our data set already contains
environmental data. Now, we want to add this environmental information
to our occupancy-detection model to explain how occupancy (or detection)
varies across environmental gradients.</p>
<div id="adding-site-covariates" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Adding site
covariates</h2>
<p>In our first set of models, we assume that detection probability is
constant in space and only test the effect of different site covariates
in occupancy. For simplicity, we focus only on two site covariates
(<em>bio1</em> = mean annual temperature, and <em>tree cover</em>).
Later, we will learn how deal with multiple site (or survey)
covariates.</p>
<p>To help stabilize the numerical optimisation algorithm, we recommend
standardising the covariates. This can easily be done using the base
function <code>scale()</code>.</p>
<pre class="r"><code># Standardise all covariates to have a mean=0 and standard deviation sd=1:
redkite_env_thinned[,-c(1:7)] &lt;- scale(redkite_env_thinned[,-c(1:7)])

# Create unmarked object containing the detection and non-detection data and the covariate data:
occ_env_redkite &lt;- unmarkedFrameOccu(y = redkite_env_thinned[,4:6], siteCovs = redkite_env_thinned[,-c(1:7)])</code></pre>
<p>We use the same method as we did for our null model only that we now
add the name(s) of site covariates to the formula (the names are the
column names of our data set). Remember that the formula in the
<code>occu()</code> function of <code>unmarked</code> takes the form:
<code>occu(~survey covariates ~site covariates)</code>.</p>
<pre class="r"><code># Fitting simple single season occupancy models without survey or site covariates (intercept model):
m_occ_bio1 &lt;- occu(~1 ~ bio_1, occ_env_redkite)

# Summarise model output:
summary(m_occ_bio1)</code></pre>
<pre><code>## 
## Call:
## occu(formula = ~1 ~ bio_1, data = occ_env_redkite)
## 
## Occupancy (logit-scale):
##             Estimate   SE      z P(&gt;|z|)
## (Intercept)     55.4 75.9  0.729   0.466
## bio_1          -46.8 65.2 -0.717   0.473
## 
## Detection (logit-scale):
##  Estimate    SE     z   P(&gt;|z|)
##     -3.08 0.117 -26.3 1.18e-152
## 
## AIC: 638.1646 
## Number of sites: 653
## optim convergence code: 0
## optim iterations: 119 
## Bootstrap iterations: 0</code></pre>
<p>We can also fit quadratic or higher polynomial terms (check
<code>?poly</code>) and interactions between predictors:<br />
- the term <code>I()</code>indicates that a variable should be
transformed before being used as predictor in the formula<br />
- <code>poly(x,n)</code> creates a polynomial of degree <span
class="math inline">\(n\)</span>: <span class="math inline">\(x + x^2 +
... + x^n\)</span><br />
- <code>x1:x2</code> creates a two-way interaction term between
variables x1 and x2, the linear terms of x1 and x2 would have to be
specified separately<br />
- <code>x1*x2</code> creates a two-way interaction term between
variables x1 and x2 plus their linear terms</p>
<p>Let’s play with these notations a little bit.</p>
<pre class="r"><code># Add quadratic term:
occu(~1 ~ bio_1 + I(bio_1^2), occ_env_redkite)

# Add quadratic term using poly():
occu(~1 ~ poly(bio_1, degree=2, raw=T), occ_env_redkite)

# Add another covariate:
occu(~1 ~ bio_1 + cropland, occ_env_redkite)

# Add quadratic terms for both covariates:
occu(~1 ~ bio_1 + I(bio_1^2) + cropland + I(cropland^2), occ_env_redkite)</code></pre>
<p>Finally, let’s add a covariate to assess how detection probability
varies with elevation. Note that this variable is also part of our site
covariates in the <code>unmarkedFrameOccu</code> object. This has the
simple reason that this variable does not vary across repeated surveys
as would e.g. be the case for wind data. We can nevertheless also use
those covariates that are constant across all surveys to explain spatial
variation in detection probability.</p>
<pre class="r"><code>(m_occdet_bio1q_cropq &lt;- occu(~ESP_elv ~ bio_1 + I(bio_1^2) + cropland + I(cropland^2), occ_env_redkite))</code></pre>
<pre><code>## 
## Call:
## occu(formula = ~ESP_elv ~ bio_1 + I(bio_1^2) + cropland + I(cropland^2), 
##     data = occ_env_redkite)
## 
## Occupancy:
##               Estimate    SE     z P(&gt;|z|)
## (Intercept)      1.662 0.957  1.74 0.08251
## bio_1           -0.708 0.427 -1.66 0.09764
## I(bio_1^2)      -0.346 0.178 -1.95 0.05156
## cropland         1.218 0.526  2.32 0.02046
## I(cropland^2)   -1.445 0.505 -2.86 0.00424
## 
## Detection:
##             Estimate    SE      z  P(&gt;|z|)
## (Intercept)    -2.43 0.268 -9.072 1.17e-19
## ESP_elv         0.14 0.223  0.628 5.30e-01
## 
## AIC: 638.0071</code></pre>
</div>
<div id="model-comparison-and-selection" class="section level2"
number="3.2">
<h2><span class="header-section-number">3.2</span> Model comparison and
selection</h2>
<p>But how to decide which model best explains the observed data? A
useful statistic is the AIC, the <em>Akaike information criterion</em>,
which is part of the standard output of the <code>unmarked</code>
models. It is based on the deviance and thus conveys information about
how closely the model fits the data. It is calculated from the
log-likelihood <span class="math inline">\(L\)</span> and penalises for
the number of parameters <span class="math inline">\(p\)</span>
(regression coefficients) in the model:</p>
<p><span class="math display">\[AIC = -2 \times L + 2 \times
(p+1)\]</span> AIC thus takes into account model complexity. In general,
lower values of AIC are preferable. But caution, AIC cannot be
interpreted in absolute terms and cannot be compared between different
data sets. It can, however, provide a meaningful way to compare
different candidate models for the same data set.</p>
<p>We can simply extract the AIC from the model objects.</p>
<pre class="r"><code># Extract AIC
m_occ_bio1@AIC</code></pre>
<pre><code>## [1] 638.1646</code></pre>
<pre class="r"><code>m_occdet_bio1q_cropq@AIC</code></pre>
<pre><code>## [1] 638.0071</code></pre>
<p>The <code>unmarked</code> package also contains a function
<code>modSel()</code> function for computing AIC-based model selection.
For this, we have to provide a list of models to compare. Let’s
systematically compare the different predictor variables to explain
occupancy and detection. To do so, we have to add all candidate models
to a <code>fitList</code> object. Note that all models in the list have
to be based on the same data frame. We thus also have to refit our null
model.</p>
<pre class="r"><code># Collect the candidate models in a named list. Try to use meaningful names of the models
cand_models &lt;- fitList(
  &quot;p(1) psi(1)&quot; = occu(~1 ~ 1, occ_env_redkite),
  &quot;p(1) psi(bio1)&quot; = occu(~1 ~ bio_1, occ_env_redkite),
  &quot;p(1) psi(bio1.sqr)&quot; = occu(~1 ~ bio_1 + I(bio_1^2), occ_env_redkite),
  &quot;p(1) psi(cropland)&quot; = occu(~1 ~ cropland, occ_env_redkite),
  &quot;p(1) psi(cropland.sqr)&quot; = occu(~1 ~ cropland + I(cropland^2), occ_env_redkite),
  &quot;p(1) psi(bio1 + cropland)&quot; = occu(~1 ~ bio_1 + cropland, occ_env_redkite),
  &quot;p(1) psi(bio1.sqr + cropland)&quot; = occu(~1 ~ bio_1 + I(bio_1^2) + cropland, occ_env_redkite),
  &quot;p(1) psi(bio1.sqr + cropland.sqr)&quot; = occu(~1 ~ bio_1 +I(bio_1^2) + cropland + I(cropland^2), occ_env_redkite),
  &quot;p(elev) psi(1)&quot; = occu(~ESP_elv ~ 1, occ_env_redkite),
  &quot;p(elev) psi(bio1)&quot; = occu(~ESP_elv ~ bio_1, occ_env_redkite),
  &quot;p(elev) psi(bio1.sqr)&quot; = occu(~ESP_elv ~ bio_1 + I(bio_1^2), occ_env_redkite),
  &quot;p(elev) psi(cropland)&quot; = occu(~ESP_elv ~ cropland, occ_env_redkite),
  &quot;p(elev) psi(cropland.sqr)&quot; = occu(~ESP_elv ~ cropland + I(cropland^2), occ_env_redkite),
  &quot;p(elev) psi(bio1 + cropland)&quot; = occu(~ESP_elv ~ bio_1 + cropland, occ_env_redkite),
  &quot;p(elev) psi(bio1.sqr + cropland)&quot; = occu(~ESP_elv ~ bio_1 + I(bio_1^2) + cropland, occ_env_redkite),
  &quot;p(elev) psi(bio1.sqr + cropland.sqr)&quot; = occu(~ESP_elv ~ bio_1 +I(bio_1^2) + cropland + I(cropland^2), occ_env_redkite)
)

# Compute the summary output for model selection. When explicitly stating which candidate model is the null model, then a Nagelkerke R-square is computed.
(m_sel &lt;- modSel(cand_models, nullmod=&quot;p(1) psi(1)&quot;))</code></pre>
<pre><code>## Warning in sqrt(diag(vcov(x, altNames = TRUE))): NaNs produced</code></pre>
<pre><code>##                                      nPars    AIC delta   AICwt cumltvWt
## p(1) psi(bio1.sqr + cropland.sqr)        6 636.41  0.00 3.1e-01     0.31
## p(elev) psi(cropland.sqr)                5 637.20  0.79 2.1e-01     0.52
## p(elev) psi(bio1.sqr + cropland.sqr)     7 638.01  1.59 1.4e-01     0.65
## p(1) psi(bio1)                           3 638.16  1.75 1.3e-01     0.78
## p(1) psi(bio1.sqr)                       4 639.09  2.68 8.1e-02     0.86
## p(elev) psi(bio1)                        4 640.40  3.99 4.2e-02     0.91
## p(elev) psi(bio1.sqr)                    5 640.61  4.20 3.8e-02     0.94
## p(1) psi(cropland.sqr)                   4 641.89  5.48 2.0e-02     0.96
## p(1) psi(bio1 + cropland)                4 642.37  5.96 1.6e-02     0.98
## p(1) psi(bio1.sqr + cropland)            5 643.23  6.82 1.0e-02     0.99
## p(elev) psi(bio1 + cropland)             5 644.30  7.89 6.0e-03     0.99
## p(elev) psi(bio1.sqr + cropland)         6 645.23  8.82 3.8e-03     1.00
## p(elev) psi(cropland)                    4 647.74 11.32 1.1e-03     1.00
## p(elev) psi(1)                           3 652.74 16.32 8.8e-05     1.00
## p(1) psi(1)                              2 652.98 16.56 7.8e-05     1.00
## p(1) psi(cropland)                       3 654.98 18.56 2.9e-05     1.00
##                                          Rsq
## p(1) psi(bio1.sqr + cropland.sqr)    5.9e-02
## p(elev) psi(cropland.sqr)            5.2e-02
## p(elev) psi(bio1.sqr + cropland.sqr) 6.0e-02
## p(1) psi(bio1)                       4.0e-02
## p(1) psi(bio1.sqr)                   4.3e-02
## p(elev) psi(bio1)                    4.0e-02
## p(elev) psi(bio1.sqr)                4.4e-02
## p(1) psi(cropland.sqr)               3.6e-02
## p(1) psi(bio1 + cropland)            3.5e-02
## p(1) psi(bio1.sqr + cropland)        3.8e-02
## p(elev) psi(bio1 + cropland)         3.5e-02
## p(elev) psi(bio1.sqr + cropland)     3.8e-02
## p(elev) psi(cropland)                2.2e-02
## p(elev) psi(1)                       5.4e-03
## p(1) psi(1)                          0.0e+00
## p(1) psi(cropland)                   7.7e-07</code></pre>
<p>The output provides different useful summary statistics.</p>
<ul>
<li><code>delta</code> refers to the <span class="math inline">\(\Delta
AIC\)</span> and is the difference in AIC between different models,
relative to the smallest AIC found in the candidate model set, meaning
relative to the best model. When the number of candidate models is
reasonably small, the <span class="math inline">\(\Delta AIC\)</span>
can be interpreted straightforwardly. A <span
class="math inline">\(\Delta AIC\)</span> between 0 and 2 indicates
substantial support for the candidate models, meaning they are
essentially as good as the best model, while values between 4-7 indicate
considerably less support compared to the best model, and a value
greater than 10 indicates no support for the candidate model <span
class="citation">(Burnham and Anderson 2002)</span>.</li>
<li><code>AICwt</code> refers to the <em>Akaike weight</em>, which is
the relative likelihood of a model compared to all other models in the
candidate model set. These weights are normalised to sum to 1 and are
typically interpreted as probability that the model is the best
performing <span class="citation">(Burnham and Anderson
2002)</span>.</li>
<li><code>cumltvWt</code> refers to the cumulative Akaike weights from
top to bottom.</li>
<li><code>Rsq</code> is computed when the null model is specified in the
<code>modSel()</code> function and is the Nagelkerke <span
class="math inline">\(R_{N}^{2}\)</span>, generalization of the
coefficient of determination <span class="math inline">\(R^2\)</span>
<span class="citation">(Nagelkerke 1991)</span>. Typically, <span
class="math inline">\(R^2\)</span> values in logistic regression are
rather low <span class="citation">(Hosmer and Lemeshow
2013)</span>.</li>
</ul>
<p>Often, there is no obvious best model and several models seem
similarly plausible. In such situations, model averaging can be useful
for combining several plausible models and averaging parameter estimates
or predictions <span class="citation">(Burnham and Anderson 2002;
Dormann et al. 2018)</span>. We will not specifically cover model
averaging here. For those interested in model averaging, there are
several packages that allow model averaging of occupancy models fit with
the <code>unmarked</code> package, for example using the packages
<code>AICmodavg</code> <span class="citation">(Mazerolle 2023)</span> or
<code>MuMIn</code> <span class="citation">(Bartoń 2022)</span>.</p>
</div>
<div id="multicollinearity" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span>
Multicollinearity</h2>
<p>GLMs (and many other statistical models) have problems to fit stable
parameters if two or more predictor variables are highly correlated,
resulting in so-called multicollinearity issues <span
class="citation">(Dormann et al. 2013)</span>. Thus, before we can add
more covariates to our models, we need to check for multi-collinearity
and select an initical set of covariates that are only weakly
correlated. Then, we can fit our occupancy models including multiple
predictors and with differently complex response shapes. This model can
then be further simplified by removing “unimportant” predictors.</p>
<p>Different approaches exist for quantifying and removing collinearity
<span class="citation">(Dormann et al. 2013)</span>, and we here only
introduce a single, simple and pragmatic yet efficient approach based on
pairwise correlation.</p>
<p>We first check for pairwise correlations among predictors. Generally,
correlations below |r|&lt;0.7 are considered unproblematic (or below
|r|&lt;0.5 as more conservative threshold).</p>
<pre class="r"><code>library(corrplot)

# We first estimate a correlation matrix from the covariates 
# We use Spearman rank correlation coefficient, as we do not know 
# whether all variables are normally distributed.
cor_mat &lt;- cor(occ_env_redkite@siteCovs, method=&#39;spearman&#39;)

# We can visualise this correlation matrix. For better visibility, 
# we plot the correlation coefficients as percentages.
corrplot.mixed(cor_mat, tl.pos=&#39;lt&#39;, tl.cex=0.6, number.cex=0.5, addCoefasPercent=T)</code></pre>
<p><img src="Occ4_SimpleOccModel_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>If no prior knowledge is available on the importance of different
predictors, then <span class="citation">Dormann et al. (2013)</span>
suggest to assess univariate variable importance in terms of AIC (Akaike
information criterion) or explained deviance. In practice, this means
that we fit separate occupancy-detection models for each predictor,
assess the importance of the predictor in terms of AIC and then rank the
variables according to their univariate importance. To do so, we first
need to identify all pairs of variables that have correlation |r|&gt;0.7
and remove the less important variable. <span class="citation">Dormann
et al. (2013)</span> call this the <em>select07</em> method.</p>
<p>A <code>select07_unm()</code> function is implemented in the package
<code>mecofun</code> along with some other useful functions for
teaching. We first have to install the package from the Univ. Potsdam
gitlab:</p>
<pre class="r"><code>library(devtools)
devtools::install_git(&quot;https://gitup.uni-potsdam.de/macroecology/mecofun.git&quot;)</code></pre>
<p>Now, you can load the package and try out the function. Also, check
out the help pages for <code>?select07_unm</code>.</p>
<pre class="r"><code>library(mecofun)

# Run select07()
var_sel &lt;- select07_unm(occ_env_redkite, names(occ_env_redkite@siteCovs), threshold=0.7)

# Check out the structure of the resulting object:
str(var_sel)</code></pre>
<pre><code>## List of 3
##  $ AIC     : Named num [1:23] 600 634 636 637 638 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:23] &quot;bio_3&quot; &quot;bio_2&quot; &quot;bio_9&quot; &quot;bio_17&quot; ...
##  $ cor_mat : num [1:23, 1:23] 1 -0.8538 0.0425 -0.4327 0.3346 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : chr [1:23] &quot;ESP_elv&quot; &quot;bio_1&quot; &quot;bio_2&quot; &quot;bio_3&quot; ...
##   .. ..$ : chr [1:23] &quot;ESP_elv&quot; &quot;bio_1&quot; &quot;bio_2&quot; &quot;bio_3&quot; ...
##  $ pred_sel: chr [1:10] &quot;bio_3&quot; &quot;bio_2&quot; &quot;bio_9&quot; &quot;bio_11&quot; ...</code></pre>
<pre class="r"><code># We extract the names of the weakly correlated predictors ordered by the univariate variable importance in terms of AIC:
pred_sel &lt;- var_sel$pred_sel</code></pre>
<p>So, we have now reduced our set of covariates that are only weakly
correlated. Now, we need to decide whether all of the remaining should
be included in the final model, or if we select only a few, for example
the two most important variables in terms of univariate AIC. As a rule
of thumb, we should have ten observations (presence sites or absence
sites) per covariate that is included in the model <span
class="citation">(Guisan, Thuiller, and Zimmermann 2017)</span>.</p>
<pre class="r"><code># Number of presences
sum(apply(redkite_env_thinned[,4:6], 1, max))</code></pre>
<pre><code>## [1] 73</code></pre>
<pre class="r"><code># Number of absence
nrow(redkite_env_thinned) - sum(apply(redkite_env_thinned[,4:6], 1, max))</code></pre>
<pre><code>## [1] 580</code></pre>
<p>In our case, we have fewer presence sites, which will thus be the
limiting number.</p>
<div class="alert alert-info">
<p><em><strong>Exercise:</strong></em></p>
<ul>
<li>Define a full model with the weakly correlated variables including
their linear and quadratic terms. Adhere to the rule of thumb for the
number of covariates allowed in the model.</li>
<li>Compile a set of candidate models and run a model comparison. Save
the results to file.</li>
<li>Repeat the steps with your own species data that you compiled in
Practical Occ-2.</li>
</ul>
</div>
<!-- common errors in occu(): https://doi90.github.io/lodestar/fitting-occupancy-models-with-unmarked.html -->
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-MuMIn" class="csl-entry">
Bartoń, Kamil. 2022. <em>MuMIn: Multi-Model Inference</em>. <a
href="https://CRAN.R-project.org/package=MuMIn">https://CRAN.R-project.org/package=MuMIn</a>.
</div>
<div id="ref-burnham2002" class="csl-entry">
Burnham, Kenneth P., and David R. Anderson. 2002. <em>Model Selection
and Multi-Model Inference: A Practical Information-Theoretic
Approach</em>. 2nd ed. Springer.
</div>
<div id="ref-Dormann2018a" class="csl-entry">
Dormann, Carsten F., Justin M. Calabrese, Gurutzeta Guillera-Arroita,
Eleni Matechou, Volker Bahn, Kamil Bartoń, Colin M. Beale, et al. 2018.
<span>“Model Averaging in Ecology: A Review of Bayesian,
Information-Theoretic, and Tactical Approaches for Predictive
Inference.”</span> <em>Ecological Monographs</em> 88 (4): 485–504. <a
href="https://doi.org/10.1002/ecm.1309">https://doi.org/10.1002/ecm.1309</a>.
</div>
<div id="ref-Dormann2013" class="csl-entry">
Dormann, Carsten F., Jane Elith, Sven Bacher, Carsten Buchmann, Gudrun
Carl, Gabriel Carré, Jaime R. García Marquéz, et al. 2013.
<span>“Collinearity: A Review of Methods to Deal with It and a
Simulation Study Evaluating Their Performance.”</span>
<em>Ecography</em> 36 (1): 27–46. <a
href="https://doi.org/10.1111/j.1600-0587.2012.07348.x">https://doi.org/10.1111/j.1600-0587.2012.07348.x</a>.
</div>
<div id="ref-unmarked2011" class="csl-entry">
Fiske, Ian, and Richard Chandler. 2011. <span>“<span
class="nocase">unmarked</span>: An <span>R</span> Package for Fitting
Hierarchical Models of Wildlife Occurrence and Abundance.”</span>
<em>Journal of Statistical Software</em> 43 (10): 1–23. <a
href="https://www.jstatsoft.org/v43/i10/">https://www.jstatsoft.org/v43/i10/</a>.
</div>
<div id="ref-Guillera-Arroita2017" class="csl-entry">
Guillera-Arroita, Gurutzeta. 2017. <span>“Modelling of Species
Distributions, Range Dynamics and Communities Under Imperfect Detection:
Advances, Challenges and Opportunities.”</span> <em>Ecography</em> 40
(2): 281–95. <a
href="https://doi.org/10.1111/ecog.02445">https://doi.org/10.1111/ecog.02445</a>.
</div>
<div id="ref-Guisan2017" class="csl-entry">
Guisan, Antoine, Wilfried Thuiller, and Niklaus E. Zimmermann. 2017.
<em>Habitat Suitability and Distribution Models with Applications in
r</em>. Cambride University Press.
</div>
<div id="ref-Hosmer2013" class="csl-entry">
Hosmer, David W., and Stanley Lemeshow. 2013. <em>Applied Logistic
Regression</em>. 3rd ed. John Wiley &amp; Sons, Inc.
</div>
<div id="ref-Kery2015" class="csl-entry">
Kéry, Marc, and J. Andrew Royle. 2015. <em>Applied Hierarchical Modeling
in Ecology: Analysis of Distribution, Abundance and Species Richness in
r and BUGS</em>. Elsevier.
</div>
<div id="ref-AICcmodavg" class="csl-entry">
Mazerolle, Marc J. 2023. <em>AICcmodavg: Model Selection and Multimodel
Inference Based on (q)AIC(c)</em>. <a
href="https://cran.r-project.org/package=AICcmodavg">https://cran.r-project.org/package=AICcmodavg</a>.
</div>
<div id="ref-nagelkerke1991" class="csl-entry">
Nagelkerke, N. J. D. 1991. <span>“A Note on a General Definition of the
Coefficient of Determination.”</span> <em>Biometrika</em> 78: 691–92.
</div>
</div>
</div>

<!DOCTYPE html>
<html>

<br>
<hr />
<div id="footer">
<p>Damaris Zurell, Guillermo Fandos, Anne-Kathleen Malchow, Jette Reeg 2021-2023 <a href="http://creativecommons.org/licenses/by/4.0/" >(CC BY 4.0)</a>.  </p>
</div>

</html>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
